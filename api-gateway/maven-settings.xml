<?xml version="1.0" encoding="UTF-8"?>
<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0
          http://maven.apache.org/xsd/settings-1.0.0.xsd">

  <!-- Enhanced Maven Settings for Production Docker Builds -->
  <localRepository>/root/.m2/repository</localRepository>

  <!-- Offline mode disabled for dependency downloads -->
  <offline>false</offline>

  <!-- Proxy settings (configure if behind corporate firewall) -->
  <proxies>
    <!-- Example proxy configuration:
    <proxy>
      <id>corporate-proxy</id>
      <active>true</active>
      <protocol>http</protocol>
      <host>proxy.company.com</host>
      <port>8080</port>
    </proxy>
    -->
  </proxies>

  <!-- Server authentication (if needed for private repositories) -->
  <servers>
    <!-- Example server configuration:
    <server>
      <id>private-repo</id>
      <username>user</username>
      <password>pass</password>
    </server>
    -->
  </servers>

  <!-- Multiple repository mirrors for redundancy and performance -->
  <mirrors>
    <!-- Primary: Google Maven Central Mirror (reliable and fast) -->
    <mirror>
      <id>google-maven-central</id>
      <name>Google Maven Central Mirror</name>
      <url>https://maven-central.storage-download.googleapis.com/maven2/</url>
      <mirrorOf>central</mirrorOf>
    </mirror>

    <!-- Fallback: Aliyun Mirror (good global coverage) -->
    <mirror>
      <id>aliyun-central</id>
      <name>Aliyun Central Mirror</name>
      <url>https://maven.aliyun.com/repository/central</url>
      <mirrorOf>!google-maven-central</mirrorOf>
    </mirror>

    <!-- Additional fallback: UK Mirror -->
    <mirror>
      <id>uk-central</id>
      <name>UK Central Mirror</name>
      <url>https://uk.maven.org/maven2/</url>
      <mirrorOf>!google-maven-central,!aliyun-central</mirrorOf>
    </mirror>
  </mirrors>
  
  <!-- Enhanced profiles with timeout and retry configuration -->
  <profiles>
    <profile>
      <id>production-build</id>
      <activation>
        <activeByDefault>true</activeByDefault>
      </activation>

      <!-- Repository configuration with enhanced timeouts -->
      <repositories>
        <!-- Maven Central with enhanced configuration -->
        <repository>
          <id>central</id>
          <name>Maven Central Repository</name>
          <url>https://repo1.maven.org/maven2</url>
          <layout>default</layout>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
          <releases>
            <enabled>true</enabled>
            <updatePolicy>daily</updatePolicy>
            <checksumPolicy>warn</checksumPolicy>
          </releases>
        </repository>

        <!-- Spring Repository with timeouts -->
        <repository>
          <id>spring-releases</id>
          <name>Spring Releases</name>
          <url>https://repo.spring.io/release</url>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
          <releases>
            <enabled>true</enabled>
            <updatePolicy>daily</updatePolicy>
            <checksumPolicy>warn</checksumPolicy>
          </releases>
        </repository>

        <!-- Spring Milestones -->
        <repository>
          <id>spring-milestones</id>
          <name>Spring Milestones</name>
          <url>https://repo.spring.io/milestone</url>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
          <releases>
            <enabled>true</enabled>
            <updatePolicy>daily</updatePolicy>
            <checksumPolicy>warn</checksumPolicy>
          </releases>
        </repository>
      </repositories>

      <!-- Plugin repositories with enhanced configuration -->
      <pluginRepositories>
        <pluginRepository>
          <id>central</id>
          <name>Maven Plugin Repository</name>
          <url>https://repo1.maven.org/maven2</url>
          <layout>default</layout>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
          <releases>
            <enabled>true</enabled>
            <updatePolicy>daily</updatePolicy>
            <checksumPolicy>warn</checksumPolicy>
          </releases>
        </pluginRepository>

        <!-- Spring Plugin Repository -->
        <pluginRepository>
          <id>spring-plugins</id>
          <name>Spring Plugin Repository</name>
          <url>https://repo.spring.io/plugins-release</url>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
          <releases>
            <enabled>true</enabled>
            <updatePolicy>daily</updatePolicy>
          </releases>
        </pluginRepository>
      </pluginRepositories>

      <!-- Enhanced properties for timeouts and retries -->
      <properties>
        <!-- Connection timeouts (in milliseconds) -->
        <maven.wagon.http.connectionTimeout>300000</maven.wagon.http.connectionTimeout>
        <maven.wagon.http.readTimeout>300000</maven.wagon.http.readTimeout>
        <maven.wagon.rto>300000</maven.wagon.rto>

        <!-- Retry configuration -->
        <maven.wagon.httpconnectionManager.ttlSeconds>120</maven.wagon.httpconnectionManager.ttlSeconds>
        <maven.wagon.http.retryHandler.count>5</maven.wagon.http.retryHandler.count>
        <maven.wagon.http.retryHandler.requestSentEnabled>true</maven.wagon.http.retryHandler.requestSentEnabled>

        <!-- Connection pooling -->
        <maven.wagon.http.pool>true</maven.wagon.http.pool>
        <maven.wagon.httpconnectionManager.maxPerRoute>10</maven.wagon.httpconnectionManager.maxPerRoute>
        <maven.wagon.httpconnectionManager.maxTotal>50</maven.wagon.httpconnectionManager.maxTotal>

        <!-- SSL configuration -->
        <maven.wagon.http.ssl.insecure>false</maven.wagon.http.ssl.insecure>
        <maven.wagon.http.ssl.allowall>false</maven.wagon.http.ssl.allowall>
        <maven.wagon.http.ssl.ignore.validity.dates>false</maven.wagon.http.ssl.ignore.validity.dates>
      </properties>
    </profile>
  </profiles>
  
  <!-- Active profiles -->
  <activeProfiles>
    <activeProfile>production-build</activeProfile>
  </activeProfiles>

</settings>
